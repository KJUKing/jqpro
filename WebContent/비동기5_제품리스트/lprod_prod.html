<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../css/public.css">
    <script src="../js/jquery-3.7.1.js"></script> <!-- 외부스크립트 -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<script>

	$(() => {
        $('#lprod').on('change', () =>{
            lgu = $("option:selected", this).val();
            
            //자바스크립트 객체
            lguValue = {lprod_gu : lgu};       
     
            fetch('prodController.jsp' , {
                method: 'post',
                headers: "",
                body: lguvalue;
            })
            .then( res => {
            	console.log(res);
            	if(res.ok){
            		//역직렬화
            		return res.JSON();
            	}else{
            		new Error(" 오류 : " + res.statusText)
            	}
            })
            .then( data => {
            	console.log(res);
            })
            .catch(err => {
            	alert("오류 " + err)
            })
        })
    })

    //처음 확인 버튼 클릭하면 lprod의 gu와 nm정보를 option으로 출력
    const proc1 = () =>{
        fetch('lprodController.jsp')
            .then(res => {
                console.log(res)
                return res.json();
            })
            .then(data => {
            	code = "";
            	for(item of data){
            		code += `<option value="${item.lprod_gu}">${item.lprod_nm}</option>`;
            	}
            	$('#lprod').html(code);
            })
            .catch(err => {
                alert(err);
            })
    }
</script>
<body>

<div class="box">
    <h3>1. fetch
    </h3>
    <input type="button" value="확인" onclick="proc1()">
        <div class="container mt-3">
            <h2>제품 리스트</h2>
            <form>
                <label for="lprod" class="form-label">Select list (lprod):</label>
                <select class="form-select" id="lprod" name="sellist1">
                </select>
                <br>

                <label for="prod" class="form-label">select list (prod):</label>
                <select class="form-select" id="prod" name="sellist2">

                </select>
            </form>
        </div>

    <br>
</div>
<div id="result1"></div>
</body>
</html>